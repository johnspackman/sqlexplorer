<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
		<title>Eclipse SQL Explorer</title>
		<link href="style.css" media="screen" type="text/css" rel="stylesheet" />
	</head>


	<body>

		<table class="mainTable">
			
			<tr>
			
				<!-- HEADER -->						
				
				<td class="topLeft">
					<a href="http://eclipsesql.sourceforge.net/"><img src="logo.jpg" class="logo" /></a>	
				</td>
				<td class="topRight">
					<span class="headerLinks"> 
						<a href="http://eclipsesql.sourceforge.net/">Home</a> | 
						<a href="screenshots.html">Screenshots</a> | 
						<a href="http://sourceforge.net/project/showfiles.php?group_id=132863">Download</a>	| 
						<a href="http://sourceforge.net/forum/?group_id=132863">Forums</a> |
						<a href="http://sourceforge.net/tracker/?group_id=132863&atid=725498">Feature Requests</a> | 
						<a href="http://sourceforge.net/tracker/?group_id=132863&atid=725495">Bugs</a>
					</span>
				</td>
			</tr>
			
			<tr>

				<!-- MENU -->			
				
				<td class="leftBar">
				
				<div class="menu">
				<ul>
					<li><a href="index.html">Home</a></li>
					<li><a href="screenshots.html">Screenshots</a></li>
					<li><a href="features.html">Overview</a>
					<ul>
						<li><a href="drivers.html">Driver Preferences</a></li>
						<li><a href="connections.html">Connections View</a></li>
						<li><a href="sqleditor.html">SQL Editor</a></li>						
						<li><a href="sqlresults.html">SQL Results</a></li>
						<li><a href="sqlhistory.html">SQL History</a></li>
						<li><a href="structure.html">Structure View</a></li>
						<li><a href="detail.html">Detail View</a></li>						
						<li><a href="dbspecific.html">DB2, Oracle &amp; MySQL Features</a></li>											
					</ul>
					</li>
					<li><a href="extending.html">Extending SQL Explorer</a>
					<ul>
						<li><a href="exBasics.html">Create Fragment</a></li>
						<li><a href="exDetail.html">Detail Pages</a></li>
						<li><a href="exNodes.html">Structure Nodes</a></li>					
						<li>Structure Actions</li>	
						<li><a href="exEditorActions.html">Editor Actions</a></li>						
						<li><a href="exResult.html">Result Actions</a></li>						
					</ul>
					</li>
					<li><a href="help.html">Help Wanted</a></li>
				</ul>
				</div>
				<a href="http://sourceforge.net"><img class="sfLogo" src="http://sflogo.sourceforge.net/sflogo.php?group_id=132863&amp;type=1" alt="SourceForge.net Logo" /></a>
				</td>
				
				<td class="content">
		
					<!-- CONTENT START -->
					<h1>Creating new Database Structure Context Actions</h1>
					<p>In this tutorial we will be extending the net.sourceforge.sqlexplorer.nodeContextAction extension point to add
					a new context action (also known as right-click menu option) for table nodes in the Database Structure tree. Let's create a 'Rename Table' feature for a MySQL table.</p>
					<p>As you probably remember from the previous tutorials, the first step is to add the extension point on the extensions tab of the fragment.xml.</p>
					<p><img src="strucaction1.jpg" /></p>
					<p>Next, we create a new action by right clicking the extension point and adding a new action.</p>
					<p><img src="strucaction2.jpg" /></p>
					<p>The details for the extension point are very similar to the previous extension points. The only new option we see here
					is the node-type field.  Using this field, we can select for which node types our action will be available.  For this example we will use 'table'
					as the node type.  It's possible to target multiple node types, by entering a comma separated list of types in this field.</p>
					<p><img src="strucaction3.jpg" /></p>					
					<p>After you've generated the Java class, there are only 2 methods that we need to implement: <br/>
					<i>public String getText()</i>: This method should return the text for our new action that is displayed in the context menu.<br/>
					<i>public void run()</i>: This method is executed when the action is run by the user.<br/>					
					<p>For the sake of brevity, only part of the code for the run method is shown below.  The full source is available <a href="http://eclipsesql.cvs.sourceforge.net/eclipsesql/sqlexplorer_mysql/src/net/sourceforge/sqlexplorer/mysql/actions/RenameTable.java?view=markup">here</a>. 
					In the mean time, let's have a look at some of the more interesting lines.</p>
					<p><i>Line 37</i>: _selectedNodes is a protected attribute that contains an array of selected nodes in the database structure view.</p>
					<p><i>Line 40</i>: _view is a protected attribute that contains a reference to the DatabaseStructureView.  You can use this to get to many things, including a shell.</p>					
					<p><i>Line 40-52</i>: Standard SWT dialogs are used to prompt for a new table name.</p>					
					<p><i>Line 57</i>: Starting from the selected node, we can retrieve a session and it's corresponding SQLConnection.  Actions should always use the interactive connection and never the
					background connection, which is reserved for executing statements in a background thread.</p>															
					<p><i>Line 64</i>: Because our action will change the name of the current node, we'll need to force the tables' parent node to reload it's child nodes.</p>					
					<p><i>Line 65</i>: _treeViewer is a protected attribute that contains the SWT TreeViewer widget.  Here we tell it to refresh the widget UI starting from the tables' parent node.</p>															
					<p><img src="strucaction4.jpg" /></p>				
					<p>Now we are ready to test our new action.  When we run our application, we see the new option available in the context menu.</p>
					<p><img src="strucaction5.jpg" /></p>					
					<p>After selecting the rename option, a dialog appears.  Here we can enter a new table name.</p>
					<p><img src="strucaction6.jpg" /></p>																				
					<p>The table has just been renamed to abrandnewtablename. Another new feature succesfully implemented!</p>
					<p><img src="strucaction7.jpg" /></p>					


					<!-- CONTENT END -->		
				</td>
			</tr>

			</table>
	</body>
</html>